"use strict";app.controller("AbstractCtrl",["$scope","$rootScope","$log","$location","$timeout","$interval","$window","searchModel","userModel","workProposesModel","worksModel","workRecruitModel","userService","itemService","itemProposeService","itemCommentService","messageService","itemFavoriteService","notificationService","noticeService","connectionService",function($scope,$rootScope,$log,$location,$timeout,$interval,$window,searchModel,userModel,workProposesModel,worksModel,workRecruitModel,userService,itemService,itemProposeService,itemCommentService,messageService,itemFavoriteService,notificationService,noticeService,connectionService){$log.debug("AbstractCtrl Start"),$scope.resetCsrf=function(data){$("meta[name='csrf-token']").attr("content",data.password),userService.setCsrf(),itemService.setCsrf(),itemProposeService.setCsrf(),itemCommentService.setCsrf(),messageService.setCsrf(),itemFavoriteService.setCsrf(),notificationService.setCsrf(),noticeService.setCsrf(),connectionService.setCsrf()},$rootScope.$on("$routeChangeSuccess",function(){$log.debug("routeChangeSuccess"),$("a[rel=tooltip]").tooltip(),$("span[rel=tooltip]").tooltip(),$timeout(function(){$timeout(function(){$("a[rel=tooltip]").tooltip(),$("span[rel=tooltip]").tooltip();try{(void 0!=twttr||void 0!=twttr.widgets||void 0!=twttr.widgets.load)&&twttr.widgets.load(),FB.XFBML.parse()}catch(e){}},0)},500)}),$scope.doFooterFixed=function(){footerFixed(),$timeout(function(){$timeout(function(){footerFixed()},0)},500)},$scope.getParamEmailToken=function(){var url=$scope.getCurrentFullUrl();if(-1==url.indexOf("?")||-1==url.indexOf("="))return"";var params=url.substring(url.indexOf("?")+1),param=params.substring(params.indexOf("=")+1);return void 0==param||0==param.length?"":(param=param.substring(0,param.length),void 0==param||0==param.length?"":param)},$scope.getInitData=function(){var user=userModel.user.get();$scope.getMypageUserFlg||(void 0==user||null==user||void 0==user.id||null==user.id||0==user.id)&&($scope.getMypageUserFlg=!0,$scope.getMypageUser())},$scope.isLogin=function(){var userData=userModel.user.get();return void 0==userData?!1:void 0==userData.id||null==userData.id||0==userData.id||"0"==userData.id||""==userData.id?!1:!0},$scope.getMypageUser=function(){userService.getMypageUser().success(function(data){$scope.getMypageUserFlg=!1,userModel.user.set(data.user),$scope.userModel=userModel.user.get(),workProposesModel.workProposes.set(data.work_proposes),$scope.workProposes=workProposesModel.workProposes.get(),worksModel.works.set(data.items),$scope.works=worksModel.works.get()}).error(function(){$scope.getMypageUserFlg=!1})},$scope.applyEx=function(){return null==$scope.$root||null==$scope.$root.$$phase?void $scope.$apply():void("$apply"!=$scope.$root.$$phase&&"$digest"!=$scope.$root.$$phase&&$scope.$apply())},$scope.showProgressModal=function(){$("#progressDialog").modal("show")},$scope.hideProgressModal=function(){$("#progressDialog").modal("hide")},$scope.handleBlurDateInput=function(elId,model,attrId){model[attrId]=$(elId).val(),$scope.applyEx()},$scope.setErrorMessage=function(errors,title,messages){errors&&0!=errors.length&&angular.forEach(errors,function(error){messages.push(title+error)})},$scope.getMessage=function(messages){var allMassage="";return angular.forEach(messages,function(message){""!=allMassage&&(allMassage+="\xa5n"),allMassage+=message}),""==allMassage&&(allMassage="\u4e88\u671f\u305b\u306c\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"),allMassage},$scope.isError=function(errors){return void 0==errors||null==errors||""==errors?!1:!0},$scope.getLimitStringMsg=function(text,maxlength){return void 0==text||null==text?"(\u5f8c"+maxlength+"\u6587\u5b57\u5165\u529b\u53ef\u80fd\u3067\u3059)":maxlength-text.length<0?'<span style="color: #e51c23;">('+-1*(maxlength-text.length)+"\u6587\u5b57\u5165\u529b\u30aa\u30fc\u30d0\u30fc\u3067\u3059)</span>":"(\u5f8c"+(maxlength-text.length)+"\u6587\u5b57\u5165\u529b\u53ef\u80fd\u3067\u3059)"},$scope.getCurrentFullUrl=function(){return $location.$$absUrl},$scope.getCurrentUrl=function(){return 3e3==$location.$$port?$location.$$protocol+"://"+$location.$$host+":"+$location.$$port:$location.$$protocol+"://"+$location.$$host},$scope.isTopPage=function(){return $rootScope.top_page_flg=void 0!=$location.$$path&&null!=$location.$$path&&"/"==$location.$$path?!0:!1,void 0==$rootScope.top_page_flg||null==$rootScope.top_page_flg?!1:$rootScope.top_page_flg},$scope.checkDate=function(strDate){if(!strDate.match(/^\d{4}\-\d{2}\-\d{2}$/))return!1;var dateArr=strDate.split("-");if(dateArr.length<3)return!1;var year=Number(dateArr[0]),month=Number(dateArr[1]-1),day=Number(dateArr[2]);if(year>=0&&month>=0&&11>=month&&day>=1&&31>=day){var date=new Date(year,month,day);if(isNaN(date))return!1;if(date.getFullYear()==year&&date.getMonth()==month&&date.getDate()==day)return!0}return!1},$scope.getFormatDateTime=function(dateStr){if(void 0==dateStr||null==dateStr||""==dateStr)return"";dateStr=dateStr.replace(/-/g,"/");var date=Date.parse(dateStr),format="YYYY-MM-DD hh:mm:ss";return format=format.replace(/YYYY/g,date.getFullYear()),format=format.replace(/MM/g,("0"+(date.getMonth()+1)).slice(-2)),format=format.replace(/DD/g,("0"+date.getDate()).slice(-2)),format=format.replace(/hh/g,("0"+date.getHours()).slice(-2)),format=format.replace(/mm/g,("0"+date.getMinutes()).slice(-2)),format=format.replace(/ss/g,("0"+date.getSeconds()).slice(-2))},$scope.showLoginDialogWhenNotLogin=function(callback){$scope.errors&&void 0!=$scope.errors.is_login_check_error&&0!=$scope.errors.is_login_check_error&&(void 0!=callback&&($rootScope.notLoginCallback=callback),$("#modal-login").modal("show"),$("#inputLoginEmail").focus())},$scope.changeLogin=function(isLogin){$(".change-header li").each(function(){"divider"==$(this).attr("class")||"list"==$(this).attr("class")||"both-header"==$(this).attr("class")||("logout-header"==$(this).attr("class")?isLogin?$(this).css("display","none"):$(this).css("display",""):isLogin?$(this).css("display",""):$(this).css("display","none"))})},$scope.selectDropDownItem=function($event,model,attrId,attrName){var el=angular.element($event.currentTarget);model[attrId]=el.attr("value"),model[attrName]=el.html()},$scope.isProjectPayment=function(payment_kbn){return payment_kbn&&"122"==payment_kbn?!0:!1},$scope.getNumComma=function(value){return void 0==value||null==value?"":String(value).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},$scope.getAreaName=function(areaKbn){if(void 0==areaKbn)return"\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093";switch(String(areaKbn)){case"300":return"\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093";case"301":return"\u5317\u6d77\u9053";case"302":return"\u9752\u68ee\u770c";case"303":return"\u5ca9\u624b\u770c";case"304":return"\u5bae\u57ce\u770c";case"305":return"\u79cb\u7530\u770c";case"306":return"\u5c71\u5f62\u770c";case"307":return"\u798f\u5cf6\u770c";case"308":return"\u8328\u57ce\u770c";case"309":return"\u6803\u6728\u770c";case"310":return"\u7fa4\u99ac\u770c";case"311":return"\u57fc\u7389\u770c";case"312":return"\u5343\u8449\u770c";case"313":return"\u6771\u4eac\u90fd";case"314":return"\u795e\u5948\u5ddd\u770c";case"315":return"\u65b0\u6f5f\u770c";case"316":return"\u5bcc\u5c71\u770c";case"317":return"\u77f3\u5ddd\u770c";case"318":return"\u798f\u4e95\u770c";case"319":return"\u5c71\u68a8\u770c";case"320":return"\u9577\u91ce\u770c";case"321":return"\u5c90\u961c\u770c";case"322":return"\u9759\u5ca1\u770c";case"323":return"\u611b\u77e5\u770c";case"324":return"\u4e09\u91cd\u770c";case"325":return"\u6ecb\u8cc0\u770c";case"326":return"\u4eac\u90fd\u5e9c";case"327":return"\u5927\u962a\u5e9c";case"328":return"\u5175\u5eab\u770c";case"329":return"\u5948\u826f\u770c";case"330":return"\u548c\u6b4c\u5c71\u770c";case"331":return"\u9ce5\u53d6\u770c";case"332":return"\u5cf6\u6839\u770c";case"333":return"\u5ca1\u5c71\u770c";case"334":return"\u5e83\u5cf6\u770c";case"335":return"\u5c71\u53e3\u770c";case"336":return"\u5fb3\u5cf6\u770c";case"337":return"\u9999\u5ddd\u770c";case"338":return"\u611b\u5a9b\u770c";case"339":return"\u9ad8\u77e5\u770c";case"340":return"\u798f\u5ca1\u770c";case"341":return"\u4f50\u8cc0\u770c";case"342":return"\u9577\u5d0e\u770c";case"343":return"\u718a\u672c\u770c";case"344":return"\u5927\u5206\u770c";case"345":return"\u5bae\u5d0e\u770c";case"346":return"\u9e7f\u5150\u5cf6\u770c";case"347":return"\u6c96\u7e04\u770c";case"348":return"\u6d77\u5916"}},$scope.getWorkKbnName=function(workKbn){switch(workKbn){case"1":return"\u30b7\u30b9\u30c6\u30e0\u958b\u767a\u30fb\u904b\u7528 -> Web\u30fb\u30b7\u30b9\u30c6\u30e0\u958b\u767a";case"2":return"\u30b7\u30b9\u30c6\u30e0\u958b\u767a\u30fb\u904b\u7528 -> \u30b9\u30de\u30db\u30a2\u30d7\u30ea\u30fb\u30e2\u30d0\u30a4\u30eb\u958b\u767a";case"3":return"\u30b7\u30b9\u30c6\u30e0\u958b\u767a\u30fb\u904b\u7528 -> \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a";case"4":return"\u30b7\u30b9\u30c6\u30e0\u958b\u767a\u30fb\u904b\u7528 -> \u904b\u7528\u30fb\u7ba1\u7406\u30fb\u4fdd\u5b88";case"11":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> \u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\u5236\u4f5c\u30fb\u30c7\u30b6\u30a4\u30f3";case"12":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> \u30b9\u30de\u30fc\u30c8\u30d5\u30a9\u30f3\u30fb\u30e2\u30d0\u30a4\u30eb\u30b5\u30a4\u30c8\u5236\u4f5c";case"13":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> \u30d0\u30ca\u30fc\u30fb\u30a2\u30a4\u30b3\u30f3\u30fb\u30dc\u30bf\u30f3";case"14":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> EC\u30b5\u30a4\u30c8\u30fb\u30cd\u30c3\u30c8\u30b7\u30e7\u30c3\u30d7\u69cb\u7bc9\u30fb\u904b\u7528";case"15":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> Web\u30de\u30fc\u30b1\u30c6\u30a3\u30f3\u30b0\u30fbHP\u96c6\u5ba2";case"16":return"Web\u5236\u4f5c\u30fbWeb\u30c7\u30b6\u30a4\u30f3 -> \u904b\u55b6\u30fb\u66f4\u65b0\u30fb\u4fdd\u5b88\u30fbSNS\u904b\u7528";case"21":return"\u30c7\u30b6\u30a4\u30f3\u5236\u4f5c -> \u30ed\u30b4\u30fb\u30a4\u30e9\u30b9\u30c8\u30fb\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"22":return"\u30c7\u30b6\u30a4\u30f3\u5236\u4f5c -> \u5370\u5237\u7269\u30fbDTP\u30fb\u305d\u306e\u4ed6";case"23":return"\u30c7\u30b6\u30a4\u30f3\u5236\u4f5c -> POP\u30fb\u30b7\u30fc\u30eb\u30fb\u30e1\u30cb\u30e5\u30fc";case"24":return"\u30c7\u30b6\u30a4\u30f3\u5236\u4f5c -> \u770b\u677f\u30fb\u5730\u56f3\u30fb\u30a4\u30f3\u30d5\u30a9\u30b0\u30e9\u30d5\u30a3\u30c3\u30af";case"25":return"\u30c7\u30b6\u30a4\u30f3\u5236\u4f5c -> \u30d7\u30ed\u30c0\u30af\u30c8\u30fb3D";case"31":return"\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30cd\u30fc\u30df\u30f3\u30b0 -> \u30e9\u30a4\u30c6\u30a3\u30f3\u30b0";case"32":return"\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30cd\u30fc\u30df\u30f3\u30b0 -> \u30cd\u30fc\u30df\u30f3\u30b0\u30fb\u30b3\u30d4\u30fc";case"33":return"\u30e9\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30cd\u30fc\u30df\u30f3\u30b0 -> \u7de8\u96c6\u30fb\u6821\u6b63";case"41":return"\u30bf\u30b9\u30af\u30fb\u4f5c\u696d -> \u30c7\u30fc\u30bf\u4f5c\u6210\u30fb\u30c6\u30ad\u30b9\u30c8\u5165\u529b";case"42":return"\u30bf\u30b9\u30af\u30fb\u4f5c\u696d -> \u30ec\u30d3\u30e5\u30fc\u30fb\u6295\u7a3f\u30fb\u30a2\u30f3\u30b1\u30fc\u30c8";case"43":return"\u30bf\u30b9\u30af\u30fb\u4f5c\u696d -> \u8abf\u67fb\u30fb\u5206\u6790\u30fb\u305d\u306e\u4ed6";case"44":return"\u30bf\u30b9\u30af\u30fb\u4f5c\u696d -> \u5185\u8077\u30fb\u8efd\u4f5c\u696d\u30fb\u4ee3\u884c";case"51":return"\u30de\u30eb\u30c1\u30e1\u30c7\u30a3\u30a2 -> \u52d5\u753b\u30fb\u5199\u771f\u30fb\u753b\u50cf";case"52":return"\u30de\u30eb\u30c1\u30e1\u30c7\u30a3\u30a2 -> \u6f2b\u753b\u30fb\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30fb\u30c9\u30e9\u30de";case"53":return"\u30de\u30eb\u30c1\u30e1\u30c7\u30a3\u30a2 -> \u97f3\u697d\u30fb\u97f3\u6e90\u30fb\u30ca\u30ec\u30fc\u30b7\u30e7\u30f3";case"61":return"\u7ffb\u8a33 -> \u82f1\u8a9e\u7ffb\u8a33\u30fb\u82f1\u6587\u7ffb\u8a33";case"62":return"\u7ffb\u8a33 -> \u4e2d\u56fd\u8a9e\u7ffb\u8a33";case"63":return"\u7ffb\u8a33 -> \u97d3\u56fd\u8a9e\u7ffb\u8a33";case"64":return"\u7ffb\u8a33 -> \u30d5\u30e9\u30f3\u30b9\u8a9e\u7ffb\u8a33";case"65":return"\u7ffb\u8a33 -> \u30b9\u30da\u30a4\u30f3\u8a9e\u7ffb\u8a33";case"66":return"\u7ffb\u8a33 -> \u30c9\u30a4\u30c4\u8a9e\u7ffb\u8a33";case"67":return"\u7ffb\u8a33 -> \u305d\u306e\u4ed6\u7ffb\u8a33";case"68":return"\u7ffb\u8a33 -> \u6620\u50cf\u7ffb\u8a33\u30fb\u51fa\u7248\u7ffb\u8a33\u30fb\u30e1\u30c7\u30a3\u30a2\u7ffb\u8a33";case"71":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u4f01\u753b\u30fbPR";case"72":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u30ea\u30b5\u30fc\u30c1\u30fb\u5206\u6790\u30fb\u89e3\u6790";case"73":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u30bb\u30fc\u30eb\u30b9\u30fb\u30d3\u30b8\u30cd\u30b9\u30b5\u30dd\u30fc\u30c8";case"74":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u8cc7\u6599\u4f5c\u6210\u30b5\u30dd\u30fc\u30c8";case"75":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u30b3\u30f3\u30b5\u30eb\u30c6\u30a3\u30f3\u30b0";case"76":return"\u4f01\u753b\u30fb\u30ea\u30b5\u30fc\u30c1\u30fb\u305d\u306e\u4ed6 -> \u305d\u306e\u4ed6";default:return"\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093"}},$scope.initCommon=function(){var datetimepicker=$(".date").datetimepicker({format:"YYYY-MM-DD",language:"ja",autoclose:"true"});datetimepicker.unbind(),datetimepicker.on("change",function(){$(".bootstrap-datetimepicker-widget").css("display","none")})},$scope.initCommon(),$scope.getInitData(),void 0==$rootScope.intarvalStop&&($rootScope.intarvalStop=$interval(function(){return void 0==$rootScope.mainRootHeight?($rootScope.mainRootHeight=$("#main-root").height(),void $scope.doFooterFixed()):($rootScope.mainRootHeight!=$("#main-root").height()&&$scope.doFooterFixed(),void($rootScope.mainRootHeight=$("#main-root").height()))},200))}]);