"use strict";app.controller("MainCtrl",["$scope","$rootScope","$controller","$interval","$location","$log","userModel","workProposesModel","worksModel","searchModel","workRecruitModel","userService","notificationService",function($scope,$rootScope,$controller,$interval,$location,$log,userModel,workProposesModel,worksModel,searchModel,workRecruitModel,userService,notificationService){$controller("AbstractCtrl",{$scope:$scope}),$log.debug("MainCtrl Start"),$scope.userModel=userModel.user.get(),$scope.workProposes=workProposesModel.workProposes.get(),$scope.works=worksModel.works.get(),$scope.search=JSON.parse(JSON.stringify(searchModel.search.get())),$scope.$on("changedSearch",function(){$scope.search=searchModel.search.get()}),$scope.$on("changedUser",function(){$scope.userModel=userModel.user.get()}),$interval(function(){$log.debug("MainCtrl interval ------>"),notificationService.getNotifications().success(function(data){void 0!=data&&""!=data&&void 0!=data.notification_msg_count&&void 0!=data.notification_inf_count&&($scope.userModel=userModel.user.get(),$scope.userModel.notification_msg_count=data.notification_msg_count,$scope.userModel.notification_inf_count=data.notification_inf_count,userModel.user.set($scope.userModel))}).error(function(){})},5e3),$scope.selectDropDownItemCall=function($event,model,attrId,attrName){$scope.selectDropDownItem($event,model,attrId,attrName),searchModel.search.set(JSON.parse(JSON.stringify(model)))},$scope.openInfoDialog=function(){$("#modal-notice").modal("show")},$scope.openWorkSeachDialog=function(){$("#modal-work-search").modal("show")},$scope.openFirstDialog=function(){$("#modal-first").modal("show"),$("#inputRegistEmail").focus()},$scope.openLoginDialog=function(){$("#modal-login").modal("show"),$("#inputLoginEmail").focus()},$("#modal-login").on("hidden.bs.modal",function(){void 0!=$rootScope.notLoginCallback&&($rootScope.notLoginCallback(),$rootScope.notLoginCallback=void 0)}),$scope.openRecruitDialog=function(){workRecruitModel.workRecruit.init();var workRecruit=workRecruitModel.workRecruit.get(),dayAfter=new Date((new Date).getTime()+10368e5);workRecruit.limit_date=String(dayAfter.getFullYear())+"/"+String(dayAfter.getMonth()+1)+"/"+String(dayAfter.getDate()),workRecruitModel.workRecruit.set(workRecruitModel.workRecruit.get()),$("#modal-recruit").modal("show")},$scope.openMypageDialog=function(){-1==$location.path().indexOf("mypage")&&($scope.showProgressModal(),$scope.getMypageUser()),$location.path("/mypage")};var stop;$("#modal-profile").on("shown.bs.modal",function(){$scope.getMypageUser(),stop=$interval(function(){$("#modal-profile").modal("handleUpdate")},200)}),$("#modal-profile").on("hidden.bs.modal",function(){angular.isDefined(stop)&&$interval.cancel(stop)}),$("#modal-recruit").on("shown.bs.modal",function(){stop=$interval(function(){$("#modal-recruit").modal("handleUpdate")},200)}),$("#modal-recruit").on("hidden.bs.modal",function(){angular.isDefined(stop)&&$interval.cancel(stop)}),$("#modal-notice").on("shown.bs.modal",function(){$scope.getMypageUser(),stop=$interval(function(){$("#modal-notice").modal("handleUpdate")},200)}),$("#modal-notice").on("hidden.bs.modal",function(){angular.isDefined(stop)&&$interval.cancel(stop)}),$("#modal-propose-ok-message").on("shown.bs.modal",function(){stop=$interval(function(){$("#modal-propose-ok-message").modal("handleUpdate")},200)}),$("#modal-propose-ok-message").on("hidden.bs.modal",function(){angular.isDefined(stop)&&$interval.cancel(stop)})}]);